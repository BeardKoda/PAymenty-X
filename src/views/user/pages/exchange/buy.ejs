<%- include('../../partials/top') %>
<!-- main content -->
    <div class="content-main" id="content-main">
        <div>
            <div class="padding">
                <div class="row">
                    <div class="col-6 col-md-4 col-lg-4">
                        <div class="box p-3">
                            <div class="d-flex"><span class="text-dark text-md"><i class="cc "></i></span></div>
                            <div class="pt-3 text-center"><span class="text-muted text-small"><small>Total Transaction Count</small></span></div>
                            <div class="pb-3 text-center text-lg"> <%=trans.length%> </div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-4">
                        <div class="box p-3">
                            <div class="d-flex"><span class="text-dark text-md"><i class="cc "></i></span></div>
                            <div class="pt-3 text-center"><span class="text-muted text-small"><small>Total Transaction Amount</small></span></div>
                            <div class="pb-3 text-center text-lg">$<%=total.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,')%> </div>
                        </div>
                    </div>
                    <div class="col-6 col-md-4 col-lg-4">
                        <div class="box p-3">
                            <div class="d-flex"><span class="text-dark text-md"><i class="cc "></i></span></div>
                            <div class="pt-3 text-center"><span class="text-muted text-small"><small>Latest Transaction Amount</small></span></div>
                            <div class="pb-3 text-center text-lg"><%if(trans.length > 0){%>$<%=Ltotal.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,')%> <%}else{%>0.00<%}%></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <p>All Buy Transaction History</p>
                        <div class="table-responsive">
                            <div id="datatable_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">
                                <div class="row">
                                    <div class="col-sm-12">
                                        <table id="datatable" class="table v-middle p-0 m-0 box dataTable no-footer"style="width: 1168px;">
                                            <thead>
                                                <tr role="row">
                                                    <th>id</th>
                                                    <th>Date</th>
                                                    <th>Amount</th>
                                                    <th>Type</th>
                                                    <th>Status</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <%no=1%>
                                                <%trans.forEach((t)=>{%>
                                                    <%  var current_datetime =t.createdAt %>
                                                <% var Ldated = current_datetime.getFullYear() + "-" + (current_datetime.getMonth() + 1) + "-" + current_datetime.getDate() + " " + current_datetime.getHours() + ":" + current_datetime.getMinutes() + ":" + current_datetime.getSeconds()%>
                                                <% var obj = t.data ? JSON.parse(t.data):" " %>
                                                <tr>
                                                    <td><%=no++%></td>
                                                    <td><%=Ldated%></td>
                                                    <td><%=t.amount%> <%=t.currencyFrom%></td>
                                                    <td><%=t.type%></td>
                                                    <td><span class="badge <%if(t.status==='Awaiting'){%>warning<%}%><%if(t.status==='Paid'){%>success<%}%><%if(t.status==='Cancelled'){%>danger<%}%>"><%= t.status %></span></td>
                                                    <td><%if(t.status==='Awaiting'){%><a href="<%=obj.status_url%>" target="_blank" class="btn info mr-2">More Info</a><%}else{%><span class="btn <%if(t.status==='Awaiting'){%>warning<%}%><%if(t.status==='Paid'){%>success<%}%><%if(t.status==='Cancelled'){%>danger<%}%>"><%=t.status%></span><%}%></td>
                                                </tr>
                                                <%})%>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.20/datatables.min.js"></script>

<script>
    (function ($) {
        $("#datatable").dataTable();
    })(jQuery);

</script>
<!-- end main content -->
<%- include('../../partials/footer') %>
